# âœ… é‡è¦æ›´æ–° - è§†é¢‘åç§°è‡ªåŠ¨åŒ¹é…

## ğŸ‰ å·²ä¿®å¤é—®é¢˜

**é—®é¢˜**: ä¹‹å‰ç³»ç»Ÿæç¤º "è­¦å‘Š: GTæ–‡ä»¶ä¸­æœªæ‰¾åˆ°è§†é¢‘ 'MyVideo_191.mp4'"

**åŸå› **: æ‚¨çš„GTæ–‡ä»¶ä¸­çš„é”®åæ˜¯ `MyVideo_191`ï¼ˆä¸å«æ‰©å±•åï¼‰ï¼Œè€Œç³»ç»Ÿä½¿ç”¨å®Œæ•´æ–‡ä»¶å `MyVideo_191.mp4` æŸ¥æ‰¾

**è§£å†³**: ç³»ç»Ÿç°åœ¨ä¼š**è‡ªåŠ¨å»é™¤æ–‡ä»¶æ‰©å±•å**åè¿›è¡ŒåŒ¹é…

---

## ğŸ“‹ ç°åœ¨çš„åŒ¹é…è§„åˆ™

### è‡ªåŠ¨åŒ¹é…é€»è¾‘

```
è§†é¢‘æ–‡ä»¶: test_videos/MyVideo_191.mp4
            â†“
æå–æ–‡ä»¶å: MyVideo_191.mp4
            â†“
å»é™¤æ‰©å±•å: MyVideo_191
            â†“
åœ¨GTä¸­æŸ¥æ‰¾: database["MyVideo_191"]
            â†“
åŒ¹é…æˆåŠŸ âœ“
```

### åŒ¹é…ç¤ºä¾‹è¡¨

| GTä¸­çš„é”® | è§†é¢‘æ–‡ä»¶å | åŒ¹é…ç»“æœ | è¯´æ˜ |
|---------|-----------|---------|------|
| `MyVideo_191` | `MyVideo_191.mp4` | âœ“ åŒ¹é… | è‡ªåŠ¨å»é™¤.mp4 |
| `MyVideo_191` | `MyVideo_191.avi` | âœ“ åŒ¹é… | è‡ªåŠ¨å»é™¤.avi |
| `MyVideo_191` | `MyVideo_191.mov` | âœ“ åŒ¹é… | è‡ªåŠ¨å»é™¤.mov |
| `MyVideo_192` | `MyVideo_192.mkv` | âœ“ åŒ¹é… | è‡ªåŠ¨å»é™¤.mkv |
| `MyVideo_193` | `video_193.mp4` | âœ— ä¸åŒ¹é… | å»é™¤æ‰©å±•åååç§°ä»ä¸åŒ |

---

## ğŸš€ ç°åœ¨å¯ä»¥ç›´æ¥ä½¿ç”¨

### æ‚¨çš„GTæ–‡ä»¶

```json
{
  "database": {
    "MyVideo_191": { ... },    â† ä¸éœ€è¦åŠ .mp4
    "MyVideo_192": { ... },    â† ä¸éœ€è¦åŠ .avi
    "MyVideo_193": { ... }     â† ä¸éœ€è¦åŠ ä»»ä½•æ‰©å±•å
  }
}
```

### æ‚¨çš„è§†é¢‘æ–‡ä»¶

```
test_videos/
â”œâ”€â”€ MyVideo_191.mp4   âœ“ è‡ªåŠ¨åŒ¹é… MyVideo_191
â”œâ”€â”€ MyVideo_192.avi   âœ“ è‡ªåŠ¨åŒ¹é… MyVideo_192
â”œâ”€â”€ MyVideo_193.mov   âœ“ è‡ªåŠ¨åŒ¹é… MyVideo_193
â””â”€â”€ ...
```

### è¿è¡Œå‘½ä»¤ï¼ˆæ— éœ€ä¿®æ”¹ï¼‰

```bash
# å•è§†é¢‘æµ‹è¯•
python track_with_fight_detection.py \
    --weights best.pt \
    --source test_videos/MyVideo_191.mp4 \
    --gt-file ground_truth_example.json \
    --fps 30

# æ‰¹é‡è¯„ä¼°
python batch_evaluate.py \
    --weights best.pt \
    --video-dir ./test_videos \
    --gt-file ground_truth_example.json \
    --fps 30
```

---

## âœ… ç¡®è®¤ä¿®å¤æˆåŠŸ

ä¹‹å‰çš„è¾“å‡º:
```
åŠ è½½Ground Truth: ground_truth_example.json
è­¦å‘Š: GTæ–‡ä»¶ä¸­æœªæ‰¾åˆ°è§†é¢‘ 'MyVideo_191.mp4'   âœ—
```

ç°åœ¨çš„è¾“å‡º:
```
åŠ è½½Ground Truth: ground_truth_example.json
GTåŒ…å« 3 ä¸ªæ‰“æ¶ç‰‡æ®µ                           âœ“

æ£€æµ‹åˆ° X ä¸ªæ‰“æ¶ç‰‡æ®µ:
  ç‰‡æ®µ 1: å¸§ 2793-2946 (ç½®ä¿¡åº¦: 0.XXX)
  ...

==================================================
è¯„ä¼°ç»“æœ:
==================================================
ç²¾ç¡®ç‡ (Precision): 0.XXXX
å¬å›ç‡ (Recall):    0.XXXX
F1åˆ†æ•° (F1-Score):  0.XXXX
==================================================
```

---

## ğŸ” å¦‚æœä»ç„¶æ‰¾ä¸åˆ°è§†é¢‘

å¦‚æœç³»ç»Ÿæç¤ºæ‰¾ä¸åˆ°è§†é¢‘ï¼Œä¼šæ˜¾ç¤ºï¼š

```
è­¦å‘Š: GTæ–‡ä»¶ä¸­æœªæ‰¾åˆ°è§†é¢‘ 'MyVideo_XXX'
æç¤º: GTä¸­å¯ç”¨çš„è§†é¢‘å: ['MyVideo_191', 'MyVideo_192', 'MyVideo_193', ...]
```

**è§£å†³æ–¹æ³•**:

1. **æ£€æŸ¥è§†é¢‘æ–‡ä»¶å**ï¼ˆå»é™¤æ‰©å±•ååï¼‰æ˜¯å¦ä¸GTä¸­çš„é”®åå®Œå…¨ä¸€è‡´
   ```bash
   # è§†é¢‘æ–‡ä»¶å
   MyVideo_191.mp4  â†’ å»é™¤æ‰©å±•å â†’ MyVideo_191
   
   # GTä¸­çš„é”®å
   "MyVideo_191"
   
   # å¿…é¡»å®Œå…¨ä¸€è‡´ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰
   ```

2. **é‡å‘½åè§†é¢‘æ–‡ä»¶**ä½¿å…¶ä¸GTåŒ¹é…
   ```bash
   # å¦‚æœGTä¸­æ˜¯ MyVideo_191
   # è§†é¢‘æ–‡ä»¶åº”è¯¥æ˜¯ MyVideo_191.mp4ï¼ˆæˆ–.avi/.movç­‰ï¼‰
   
   # é”™è¯¯ç¤ºä¾‹ï¼š
   video_191.mp4    âœ— åç§°ä¸åŒ¹é…
   myvideo_191.mp4  âœ— å¤§å°å†™ä¸åŒ¹é…
   MyVideo191.mp4   âœ— ç¼ºå°‘ä¸‹åˆ’çº¿
   ```

3. **æˆ–è€…ä¿®æ”¹GTæ–‡ä»¶**ä½¿å…¶ä¸è§†é¢‘æ–‡ä»¶ååŒ¹é…
   ```json
   {
     "database": {
       "video_191": { ... }   â† æ”¹ä¸ºä¸è§†é¢‘æ–‡ä»¶åï¼ˆå»é™¤æ‰©å±•åï¼‰ä¸€è‡´
     }
   }
   ```

---

## ğŸ“ æ‰¹é‡é‡å‘½åå·¥å…·ï¼ˆå¦‚æœéœ€è¦ï¼‰

### Linux/Mac

```bash
# ç¤ºä¾‹ï¼šå°† video_191.mp4 é‡å‘½åä¸º MyVideo_191.mp4

cd test_videos
for f in video_*.mp4; do
    num=$(echo $f | grep -oP '\d+')
    mv "$f" "MyVideo_${num}.mp4"
done
```

### Windows PowerShell

```powershell
# ç¤ºä¾‹ï¼šå°† video_191.mp4 é‡å‘½åä¸º MyVideo_191.mp4

cd test_videos
Get-ChildItem video_*.mp4 | ForEach-Object {
    $num = $_.BaseName -replace '\D+', ''
    Rename-Item $_ -NewName "MyVideo_$num.mp4"
}
```

### Pythonè„šæœ¬

```python
# rename_videos.py
from pathlib import Path
import re

video_dir = Path('test_videos')

for video_file in video_dir.glob('video_*.mp4'):
    # æå–æ•°å­—
    match = re.search(r'(\d+)', video_file.stem)
    if match:
        num = match.group(1)
        new_name = f"MyVideo_{num}{video_file.suffix}"
        video_file.rename(video_dir / new_name)
        print(f"{video_file.name} â†’ {new_name}")
```

è¿è¡Œ: `python rename_videos.py`

---

## ğŸ¯ æ€»ç»“

**æ ¸å¿ƒæ”¹è¿›**:
- âœ… ç³»ç»Ÿç°åœ¨è‡ªåŠ¨å»é™¤æ–‡ä»¶æ‰©å±•åè¿›è¡ŒåŒ¹é…
- âœ… GTä¸­åªéœ€è¦ `"MyVideo_191"` è¿™æ ·çš„é”®å
- âœ… è§†é¢‘æ–‡ä»¶å¯ä»¥æ˜¯ä»»ä½•æ”¯æŒçš„æ ¼å¼ï¼ˆ.mp4/.avi/.mov/.mkvï¼‰
- âœ… æ— éœ€æ‰‹åŠ¨ä¿®æ”¹GTæ–‡ä»¶æ·»åŠ æ‰©å±•å

**ç°åœ¨å¯ä»¥ç«‹å³ä½¿ç”¨**ï¼Œæ— éœ€ä»»ä½•é¢å¤–é…ç½®ï¼

---

**æ›´æ–°æ—¥æœŸ**: 2024-11  
**é€‚ç”¨æ–‡ä»¶**: 
- track_with_fight_detection.py
- batch_evaluate.py
- visualize_results.py

